# Change the behaviors in line 8 to the ones that you had observed in your experiment. 
# The () next to each behavior is a color in the CYMK color space.
# In behavior_times for each behavior, copy and paste the duration for each behavior in seconds in this format (START, STOP). 
# Look to the bottom to change titles, labels, and sizing.


import matplotlib.pyplot as plt
from tqdm import tqdm

# Define the behaviors and their colors for the plot
behaviors = {
    'Bottom': (0.5, 0.5, 0.5, 1.0),
    'Top': (0.878, 0.361, 1.0, 1.0),
    'Freezing': (0.149, 0.522, 0.941, 1.0),
    'Normal Swimming': (1.0, 0.38, 0.0, 1.0),
    'Fast Swimming': (0.196, 0.882, 0.0, 1.0),
    'Floor Skimming': (0.31, 1.0, 0.8, 1.0),
    'Normal Turning': (0.529, 0.322, 1.0, 1.0),
    'Erratic Turning': (0.882, 0.02, 0.02, 1.0),
    'Wall Bumping': (0.494, 0.255, 0.263, 1.0)
}

# Define the behavior start and stop times in seconds
behavior_times = {
    'Bottom': [(0.0, 23.463), (24.944, 35.024), (38.024, 42.305), (44.803, 49.924), (51.821, 59.873), (61.382, 65.864), (67.912, 70.164), (73.585, 76.722), (78.202, 82.704), (84.703, 88.704), (89.724, 92.724), (94.484, 102.865), (105.564, 107.815), (109.921, 113.495), (115.493, 117.544), (118.025, 124.345), (124.844, 128.092), (129.333, 130.584), (132.333, 138.404), (138.905, 147.871), (148.871, 153.976), (155.476, 156.977), (157.976, 159.98), (166.014, 168.024), (172.824, 183.924), (187.164, 189.145), (190.043, 194.547), (197.225, 199.227), (201.724, 202.976), (203.977, 206.697), (208.696, 214.494), (215.744, 219.494), (221.286, 227.186), (229.434, 241.904), (243.154, 246.654), (247.904, 250.404), (252.404, 256.743), (258.494, 261.665), (263.165, 265.414), (266.414, 269.414), (271.665, 286.374), (287.625, 288.874), (291.374, 292.285), (294.033, 304.365), (306.114, 330.474), (332.725, 336.065), (338.174, 342.923), (343.925, 392.125), (393.356, 395.026), (397.176, 398.363), (400.426, 401.971), (402.971, 409.772), (410.692, 413.192), (414.441, 416.39), (417.29, 421.541), (423.042, 424.042), (425.242, 425.992), (427.412, 428.812), (430.31, 436.862), (442.362, 443.862), (449.362, 450.861), (451.37, 454.872), (456.962, 458.71), (460.212, 463.21), (464.681, 474.035), (475.534, 481.733), (484.594, 485.844), (488.093, 509.422), (509.935, 524.727), (527.296, 529.442), (531.053, 532.804), (534.552, 535.304), (536.556, 536.802), (538.802, 545.962), (547.716, 548.962), (551.212, 553.945), (556.019, 558.99), (560.245, 563.813), (567.062, 567.813), (569.067, 570.204), (572.953, 575.042), (577.696, 579.572), (579.821, 586.327), (589.072, 599.072)],

    'Top': [(23.463, 24.944), (35.024, 38.024), (42.305, 44.803), (49.924, 51.821), (59.873, 61.382), (65.864, 67.912), (70.164, 73.585), (76.722, 78.202), (82.704, 84.703), (88.704, 89.724), (92.724, 94.484), (102.865, 105.564), (107.815, 109.921), (113.495, 115.493), (117.544, 118.025), (124.345, 124.844), (128.092, 129.333), (130.584, 132.333), (138.404, 138.905), (147.871, 148.871), (153.976, 155.476), (156.977, 157.976), (159.98, 166.014), (168.024, 172.824), (183.924, 187.164), (189.145, 190.043), (194.547, 197.225), (199.227, 201.724), (202.976, 203.977), (206.697, 208.696), (214.494, 215.744), (219.494, 221.286), (227.186, 229.434), (241.904, 243.154), (246.654, 247.904), (250.404, 252.404), (256.743, 258.494), (261.665, 263.165), (265.414, 266.414), (269.414, 271.665), (286.374, 287.625), (288.874, 291.374), (292.285, 294.033), (304.365, 306.114), (330.474, 332.725), (336.065, 338.174), (342.923, 343.925), (392.125, 393.356), (395.026, 397.176), (398.363, 400.426), (401.971, 402.971), (409.772, 410.692), (413.192, 414.441), (416.39, 417.29), (421.541, 423.042), (424.042, 425.242), (425.992, 427.412), (428.812, 430.31), (436.862, 442.362), (443.862, 449.362), (450.861, 451.37), (454.872, 456.962), (458.71, 460.212), (463.21, 464.681), (474.035, 475.534), (481.733, 484.594), (485.844, 488.093), (509.422, 509.935), (524.727, 527.296), (529.442, 531.053), (532.804, 534.552), (535.304, 536.556), (536.802, 538.802), (545.962, 547.716), (548.962, 551.212), (553.945, 556.019), (558.99, 560.245), (563.813, 566.562), (567.813, 569.067), (570.204, 572.953), (575.042, 577.696), (579.572, 579.821), (586.327, 589.072)],

    'Normal Swimming': [(0.0, 362.654), (367.187, 379.473), (386.141, 410.591), (419.342, 421.592), (431.593, 459.21), (466.032, 490.024), (496.393, 498.705), (503.704, 541.467), (544.712, 575.695), (580.422, 599.072)],

    'Fast Swimming': [(410.591, 419.342), (421.592, 431.593), (459.21, 466.032), (575.695, 580.422)],

    'Freezing': [(345.334, 350.834), (362.654, 367.187), (379.473, 386.141), (490.024, 496.393), (498.705, 503.704), (541.467, 544.712)],

    'Floor Skimming': [(27.052, 28.304), (31.804, 33.551), (39.055, 40.304)],

    'Normal Turning': [(0.403, 1.152), (2.15, 2.653), (3.902, 4.15), (5.745, 7.244), (8.604, 9.104), (12.105, 12.604), (17.402, 17.652), (19.904, 20.652), (23.463, 23.945), (25.942, 26.444), (28.764, 29.265), (31.264, 32.013), (33.541, 34.524), (38.024, 38.524), (41.304, 41.804), (50.322, 50.572), (52.324, 53.574), (55.144, 56.645), (58.873, 59.624), (60.874, 61.382), (62.612, 62.864), (66.664, 67.164), (68.835, 70.332), (72.832, 73.333), (79.204, 81.205), (83.705, 83.954), (88.704, 90.973), (93.544, 94.544), (97.231, 97.364), (102.865, 104.624), (105.623, 105.872), (107.815, 108.924), (111.924, 112.244), (114.244, 114.992), (121.004, 121.504), (125.842, 126.844), (160.264, 161.267), (163.016, 163.764), (168.774, 169.024), (170.824, 172.574), (179.225, 180.216), (180.226, 181.425), (183.924, 184.426), (186.457, 186.705), (189.145, 190.043), (194.547, 195.297), (197.225, 197.977), (199.477, 200.226), (201.724, 202.476), (203.725, 203.977), (205.697, 205.945), (207.445, 207.697), (208.696, 209.196), (214.494, 214.994), (217.244, 217.744), (219.494, 220.034), (221.785, 222.934), (226.185, 226.685), (228.186, 228.436), (295.013, 297.014), (306.685, 308.185), (310.685, 311.234), (314.714, 315.214), (317.714, 318.465), (321.11, 322.065), (324.774, 325.774), (325.926, 326.865), (328.114, 328.863), (330.974, 331.725), (332.814, 334.314), (336.673, 337.674), (343.925, 344.605), (351.334, 351.583), (354.334, 355.414), (358.625, 360.125), (361.653, 362.654), (367.187, 367.406), (369.774, 370.774), (376.201, 377.265), (377.974, 379.473), (386.141, 387.125), (392.125, 393.856), (395.245, 395.737), (396.448, 397.446), (399.114, 400.365), (403.471, 404.971), (407.021, 408.021), (409.772, 410.341), (411.69, 412.442), (413.69, 413.942), (414.527, 415.141), (416.641, 416.89), (417.29, 417.792), (418.292, 419.041), (420.29, 420.792), (422.041, 423.042), (424.042, 424.742), (425.992, 426.41), (427.412, 428.162), (431.481, 433.232), (433.362, 434.362), (441.112, 442.11), (443.862, 444.112), (450.861, 451.37), (452.621, 453.37), (459.21, 459.71), (460.962, 461.461), (462.932, 463.93), (464.681, 465.351), (466.604, 466.681), (466.714, 468.212), (470.804, 474.035), (476.783, 478.274), (478.284, 478.732), (488.093, 489.583), (496.393, 496.974), (508.424, 508.674), (515.292, 521.975), (524.727, 526.792), (530.545, 541.467), (551.212, 552.693), (556.094, 556.996), (564.065, 565.062), (569.067, 569.702), (571.204, 571.702), (572.953, 574.045), (575.695, 576.692), (577.696, 578.345), (578.543, 579.572), (579.821, 581.324), (598.322, 599.072)],

    'Erratic Turning': [(0.0, 0.0)],

    'Wall Bumping': [(16.154, 16.164), (16.404, 16.414), (22.795, 22.805), (46.555, 46.565), (47.555, 47.565), (54.572, 54.582), (72.332, 72.342), (75.081, 75.091), (75.584, 75.594), (76.833, 76.843), (95.732, 95.742), (95.985, 95.995), (97.231, 97.241), (99.113, 99.123), (99.365, 99.375), (99.864, 99.874), (100.864, 100.874), (102.364, 102.374), (110.173, 110.183), (111.924, 111.934), (116.244, 116.254), (116.744, 116.754), (122.845, 122.855), (123.841, 123.851), (124.973, 124.983), (126.723, 126.733), (128.471, 128.481), (129.224, 129.234), (130.723, 130.733), (132.221, 132.231), (133.724, 133.734), (134.974, 134.984), (136.224, 136.234), (137.223, 137.233), (138.725, 138.735), (140.223, 140.233), (142.224, 142.234), (143.224, 143.234), (144.723, 144.733), (145.724, 145.734), (147.724, 147.734), (150.516, 150.526), (151.516, 151.526), (153.016, 153.026), (155.976, 155.986), (156.225, 156.235), (159.476, 159.486), (162.516, 162.526), (167.264, 167.274), (170.774, 170.784), (182.426, 182.436), (183.177, 183.187), (185.675, 185.685), (204.975, 204.985), (231.636, 231.646), (232.387, 232.397), (233.136, 233.146), (234.385, 234.395), (235.136, 235.146), (235.635, 235.645), (236.387, 236.397), (237.883, 237.893), (238.634, 238.644), (239.135, 239.145), (240.137, 240.147), (240.886, 240.896), (272.874, 272.884), (273.374, 273.384), (275.374, 275.384), (276.874, 276.884), (279.374, 279.384), (281.874, 281.884), (283.874, 283.884), (299.763, 299.773), (301.765, 301.775), (304.265, 304.275), (310.685, 310.695), (320.963, 320.973), (327.365, 327.375), (354.334, 354.344), (360.623, 360.633), (369.645, 369.655), (373.525, 373.535), (374.525, 374.535), (376.025, 376.035), (389.625, 389.635), (391.625, 391.635), (405.472, 405.482), (420.042, 420.052), (429.062, 429.072), (446.612, 446.622), (470.212, 470.222), (470.714, 470.724), (479.733, 479.743), (512.682, 512.692), (578.844, 578.854)
]
}

# Create a figure and axis for the plot
fig, ax = plt.subplots(figsize=(10, 3))
plt.subplots_adjust(left=0.24, bottom=0.37, right=0.96, top=0.88, wspace=0.20, hspace=0.20)
plt.subplots_adjust(bottom=0.1)
# Set the y-axis labels and limits
ax.set_yticks(list(range(len(behaviors))))
ax.set_yticklabels(list(behaviors.keys())[::-1], fontsize=30, fontfamily='Arial')  # reverse the order of the labels
ax.set_ylim(-1, len(behaviors))

ax.set_ylabel('Behaviors', fontsize=30, labelpad=20, fontfamily='Arial')

# Rotate the y-axis label
y_axis_label = ax.yaxis.get_label()
y_axis_label.set_rotation(90)

# Center the y-axis label and increase the distance between the label and y-axis ticks
ax.yaxis.label.set_ha('center')



# Loop through each behavior and plot a horizontal bar for each time interval
for i, (behavior, color) in enumerate(behaviors.items()):
    for start, stop in tqdm(behavior_times[behavior], desc=behavior):
        duration = stop - start
        ax.broken_barh([(start/60, duration/60)], (len(behaviors)-i-1-0.2, 0.4), facecolors=color)

# Set the x-axis label and limits
ax.set_xlabel('Time (minutes)', fontsize=30, fontfamily='Arial')
ax.set_xlim(0, 10)

# Set the graph title
ax.set_title('Texas', fontsize=30, pad=14, fontfamily='Arial')
plt.xticks([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], fontsize=30, fontfamily='Arial')  # reduce the font size of the x ticks
# add major gridlines that intersect with x and y ticks
ax.grid(which='major', linestyle='-', linewidth='0.5', color='gray', alpha=0.5)
# add minor gridlines that intersect with x and y ticks
ax.grid(which='minor', linestyle=':', linewidth='0.5', color='gray', alpha=0.5)

# Save the plot as a PNG image in the specified directory   
save_directory = "C:/Users/duboue_razer/Desktop/NEW ETHO_FIG2/"
save_filename = "SF4_SIMBA.png"
save_filepath = save_directory + save_filename
plt.savefig(save_filepath, dpi=300, bbox_inches='tight')

# Show the plot
plt.show()
